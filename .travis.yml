sudo: false
language: scala
jdk: oraclejdk8

jobs:
  include:
     - stage: test
       script: sbt scripted

     - stage: publish
       script: sbt publish

stages:
  # runs on master commits and PRs
  - name: test
    if: NOT tag =~ ^v

  # runs on main repo master commits or version-tagged commits
  - name: publish
    if: repo = sbt/sbt-java-formatter AND ( ( branch = master AND type = push ) OR tag =~ ^v )


before_cache:
  - find $HOME/.ivy2/ -name "ivydata-*.properties" -print -delete
  - find $HOME/.sbt   -name "*.lock"               -print -delete

cache:
  directories:
    - $HOME/.ivy2/cache
    - $HOME/.sbt/boot

env:
  global:
    # encrypt with: travis encrypt BINTRAY_USER=...
    - secure: "IpIh6mqFxDT5JVwb3Z4OT4gryyilTnZ4kJ1Spi+h3q+eA/JY0v/nwKHMDlTF30KQBrS5mUnzUSLmETNZk19kIrTBsO2KNZkMQhdRQgm/ZAVpVs04jj+9b5rAV+LHa86SQReDVVniqm5fxxU7mYv1s5paPWLVuOFgP+bD90t9RztJPnVvwFx4z9dg7mTlopbn4IfWMPG8jH5F8qYUYuwWGv3BrQVshRqGu2Mcz9RHit8cwbodHnr7eqQ27xmiLX6E0kEFzmjVXdBqSwfXcz9xtk/1n7kA0cFOY0SSQKcwekW6HPbxZ4JhosNkjNHX95Ea3FRIVXha8i+0rfuImTYWcKmcwkM5BreOnIOmw/35OoD/VZHsdRBa7PWb0ZFyb5FmBVG/rorbwB80O8SCUnJQSm+v6rnC++UD2v9dap78o5F98F7pqPPNcMeZyrVVgAKkeOOW65gv9PVBIUgHmUl7ugc7gJuWcVh+N9j9in5UB9jZaQci8Fm2Fk3wTvID3ZknYlME6nq527QLtdHbPWe4t1AtVKGjVqLjxudRGKQuhuL/Y0lYwDYfv+X9IFPscimI6cTrJ96BOleWuvVj2ryFVStXcsh5lriNYkcTkAWpYiLEg1nJ9MlSdIVpWXtOsSfvXdqY9lemVVZeO2kzoA9MY4OecbDTPWRqBA82CoACzbI="
    # encrypt with: travis encrypt BINTRAY_PASS=...
    - secure: "LzrcF2sYVYbRtNLyWHBo6xCx2GCP0Xwc1JnRPMcFrP1FIrscaqIvYJM9YASpm4z2MtG0Hj27y/ChnbAR1/ZYLI+ymhZpM0jpkRXT6D+UqwOgQnY/F852prtRV9YR2O6eqS/+CUeSR63Z1uiZ74a01/OOHIUlYnkHbwhv00cNbbTDagxoKbYk5ktpcGscw5xnabqLuMcC0PD1SDZOCaqaJD/LvdwB7C6VdJHU4E2X7Mr4OP4RzFbFG6JXaA28DiS//7Hb4hWzTdtmoaGyDxHBtvqrnzduDwLPkst1449SMBjIr4yjw+Do+xz2NjI3BRNviQ3V3B++QR9G6qGFXOrc5oYfZV1N9Fk74JjMnvazMVWXnDnTocUAF7R+Mnf/TU1oCj3MjpR0JTqV89Zem1FZt3DBBiInxCQjmsx5nyH28gUepk27wt4lPSCNH5Rab7jBvjDZN8i5kGn2k+THKDtR+yKH8CY7sJU5alr6NJigBzs3xMaym7QPmJfmlGc1BtgYRaPgulgjlxRhtDdVmU1+aPnBfY0wv7oZzsLJgUySznIeke6/cj/E5rM8ZgFyv6yAzQEp4P3nEG5XkteDiuBsCawcrrWoq4zwEcizSJgOaNtMi737Qio4ZEpYvNhi8wG64zWExkii80Pg2NRLwNZCF0R0XKZrQ062z2iCNoydTlU="
